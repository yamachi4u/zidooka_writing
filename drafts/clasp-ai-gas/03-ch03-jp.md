---
title: "第3章：あなたの「デジタルの部下」に仕事を任せるための最初の挨拶"
slug: "clasp-gas-beginner-ch03-jp"
status: "publish"
date: "2025-12-12T14:45:45.577Z"
categories: 
  - "Clasp-AI入門"
  - "Tech"
tags: 
  - "GAS"
  - "Clasp"
  - "Beginner"
  - "Automation"
  - "Authentication"
featured_image: "../../images/clasp-ai-gas-thumb.png"
parent: "clasp-gas-beginner-intro-jp"
---

**この章でできるようになること**：
*   Google Apps Script APIをオンにする
*   ClaspとGoogleアカウントを接続する（認証）
*   **かかる時間**：5〜10分
*   **つまずきやすい所**：警告画面が出てビックリする（正常です！）

いよいよ、あなたの代わりに24時間働いてくれる「デジタルの部下（GAS）」に、あなたのパソコンから指示を出せるようにします。`clasp login`という「挨拶」の儀式です。少し専門的な画面も出ますが、この記事通りに進めれば大丈夫。ここを乗り越えれば、自動化の世界はもう目の前です！

## 1. なぜ「挨拶（ログイン）」が必要なのか？

前回、あなたのパソコンに `Clasp` という「GASへの通訳ツール」を入れました。
しかし、今のままでは `Clasp` はあなたのGoogleドライブやスプレッドシートを勝手に見ることはできません。当然ですよね。部下だからといって、社長の机の引き出しを勝手に開けたら大問題です。

そこで、**「このパソコンからの指示は、私（あなた）の指示ですよ」** とGoogleに教えてあげるための「挨拶（ログイン認証）」という儀式が必要になります。

これは一度だけ行えばOKです。さあ、サクッと済ませてしまいましょう！

## 2. Step 1: 部下が通る「専用ドア」の鍵を開ける

まず、あなたのGoogleアカウント側で、`Clasp` のような外部ツールからの指示を受け付けるための「専用ドア（API）」の鍵を開けます。
普段はセキュリティのために閉まっているので、これを開けてあげるイメージです。

1.  ブラウザで [Google Apps Script 設定ページ](https://script.google.com/home/usersettings) にアクセスします。
    - ※もしGoogleにログインしていない場合は、自動化で使いたいアカウント（個人のGmailアカウントなど）でログインしてください。
2.  **「Google Apps Script API」** という項目を見つけてください。
3.  スイッチをクリックして **「オン」**（青色）にします。

<!-- ここに「Google Apps Script API」の設定画面のスクリーンショットを入れる -->

これだけです！社長室のドアを開けて「入ってよろしい」と許可するようなものですね。
これを忘れると、あとで部下が「社長、ドアが開きません！」(`User has not enabled the Google Apps Script API`) と言ってきてしまいます。

## 3. Step 2: 通訳ツール(Clasp)と固い握手を交わす

いよいよ、あなたのパソコンとGoogleアカウントを繋げます。
ターミナル（黒い画面）に戻って、以下の「挨拶コマンド」を打ち込み、Enterキーを押してください。

```bash
clasp login
```

すると、自動でブラウザが開き、Googleのログイン画面が表示されます。

### 画面の指示に従うだけ！
1.  **アカウントの選択**: 先ほど「専用ドア」の鍵を開けたGoogleアカウントを選びます。
2.  **アクセスのリクエスト**: 「Claspが、あなたのGoogleアカウントへのアクセスを求めています」という画面が出ます。これは、部下が「請求書のデータをスプレッドシートに書いてもいいですか？」と許可を求めているのと同じです。
    - ここで **「許可」** をクリックします。

### ⚠️「このアプリはGoogleによって確認されていません」という警告画面が出たら？
事業で使う上で、一番ドキッとする画面かもしれません。ご安心ください。これは**正常な動作**です。

これは「Claspというツールは、AppStoreで売っているような一般消費者向けのアプリではなく、開発者が使う専門ツールですよ。本当に信頼できますか？」とGoogleの警備員さんが念の為に確認してくれているだけです。
`Clasp`はGoogle自身が作っている公式ツールなので、信頼性は抜群です。社長のあなたが「大丈夫、私の部下だ」と許可してあげましょう。

1.  左下の **「詳細」** というリンクをクリック。
2.  **「（安全ではないページ）に移動」** をクリック。
3.  その後の画面で「許可」を押す。

<!-- ここに「このアプリはGoogleによって確認されていません」の警告画面のスクリーンショットを入れる -->

### 挨拶成功のサイン
ブラウザに以下の英語が表示されたら、挨拶は成功です！

> `Logged in! You may close this page.`
> （訳：ログインしました！このページは閉じて大丈夫です。）

ブラウザを閉じて、ターミナルに戻ってみましょう。

**成功時の表示例**：
```text
Saved the credentials to C:\Users\User\.clasprc.json
```

このメッセージが出ていれば、あなたのパソコンとGoogleアカウントの間に信頼のパイプが繋がった証拠です。
※「credentials（クレデンシャル）」とは「合鍵」のことです。あなたのPCの安全な場所に、Googleへの合鍵が保存されました。

## 4. よくある質問 (Q&A)

### Q1. 会社のアカウントと個人のアカウント、どっちがいい？
**A. 最初は「個人のGmailアカウント」で練習しましょう。**
会社のGoogleアカウント（Google Workspace）の場合、管理者の設定により「外部ツールからのアクセス」が禁止されていることがあります。
まずは個人のアカウントで慣れてから、会社のIT部門に相談するのがスムーズです。

### Q2. 複数のGoogleアカウントを使っているのですが...
**A. ブラウザで「使いたいアカウントだけ」にログインした状態でやりましょう。**
複数のアカウントにログインしていると、意図しない方のアカウントで認証されてしまうことがあります。
一番確実なのは、**「シークレットウィンドウ」** でURLを開くか、一度すべてのアカウントからログアウトしてから行うことです。

### Q2. アカウントを切り替えたいときは？
**A. 一度ログアウトしてから、再度ログインします。**

```bash
clasp logout  # 今の部下との関係を解消
clasp login   # 別の部下と新しく挨拶する
```

### Q3. 「ログイン」は毎回やる必要がありますか？
**A. いいえ、一度だけでOKです。**
パソコンを再起動しても、ログイン状態は維持されます。

## 5. 理解度チェッククイズ

**Q1. Claspを使う前に、ブラウザで「オン」にする必要がある設定は？**
A. Google Maps API
B. Google Apps Script API
C. YouTube API

**Q2. `clasp login` コマンドを打つと何が起きる？**
A. パソコンが再起動する
B. ブラウザが開いて、Googleのログイン画面が出る
C. Googleから電話がかかってくる

**Q3. 「このアプリは確認されていません」と出たらどうする？**
A. 怖いのでブラウザを閉じる
B. 「詳細」→「安全ではないページに移動」→「許可」と進む
C. パソコンの電源を切る

<details>
<summary>答え合わせ（クリックして開く）</summary>

**Q1: B**
「Google Apps Script API」をオンにしないと、Claspは動きません。

**Q2: B**
ブラウザで認証を行います。

**Q3: B**
これは開発者向けツール特有の警告です。Claspは公式ツールなので安全です。

</details>

---

これで、あなたの「デジタルの部下」にいつでも指示を出せる準備が整いました。
ここが一番の専門用語の壁でした。本当にお疲れ様でした！

次章から、いよいよ「請求書作成ロボット」や「売上レポート自動生成くん」を作るための、具体的なプロジェクト作成に入っていきます。ワクワクしますね！

---
**次章でやること**：
*   `clasp create` で新しいプロジェクトを作る
*   `clasp open` でブラウザを開く
*   VS Codeでプロジェクトを開く

[＞＞ 次の章：第4章 最初のGASプロジェクトを作ってみる](https://www.zidooka.com/archives/1592)

## 連載目次

- [【固定記事】完全初心者のための Clasp × GAS 完全入門（ZIDOOKA！）](https://www.zidooka.com/archives/1568)
- [第0章：そもそもGASとClaspって何？](https://www.zidooka.com/archives/1562)
- [第1章：Claspを使う前に知っておく最低限のこと](https://www.zidooka.com/archives/1574)
- [第2章：Claspを使うための環境を作る](https://www.zidooka.com/archives/1580)
- **第3章：GoogleアカウントとClaspをつなぐ** (Current)
- [第4章：最初のGASプロジェクトを作ってみる](https://www.zidooka.com/archives/1592)
- [第5章：GASのコードを書いてみる](https://www.zidooka.com/archives/1598)
- [第6章：push / pull を理解する](https://www.zidooka.com/archives/1604)
- [第7章：GASを「実際の業務」に使うイメージ](https://www.zidooka.com/archives/1610)
- [第8章：初心者が必ずハマるポイント集](https://www.zidooka.com/archives/1616)
- [第9章：次にやるべきこと](https://www.zidooka.com/archives/1622)

