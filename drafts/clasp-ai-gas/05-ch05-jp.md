---
title: "第5章：ロボットに最初の命令（コード）を書いてみよう"
slug: "clasp-gas-beginner-ch05-jp"
status: "publish"
date: "2025-12-12T14:45:45.577Z"
categories: 
  - "Clasp-AI入門"
  - "Tech"
tags: 
  - "GAS"
  - "Clasp"
  - "Beginner"
  - "Automation"
  - "Coding"
featured_image: "../../images/clasp-ai-gas-thumb.png"
parent: "clasp-gas-beginner-intro-jp"
---

**この章でできるようになること**：
*   VS CodeでGASのコードを書く
*   `clasp push` でクラウドにアップロードする
*   実際に動かしてログを確認する
*   **かかる時間**：15〜20分
*   **つまずきやすい所**：`clasp push` を忘れて「動かない！」となる

いよいよ、あなたの代わりに働くロボットの「頭脳」を作っていきます。VS Codeで命令書（コード）を書き、それをGoogleのサーバーにいるロボット本体に送信（プッシュ）し、正しく動くか確認するまでの一連の流れを体験します。AI（Copilot）に手伝ってもらう方法も紹介！

## 1. VS Code で「命令書」ファイルを作る

前章で `code .` を使って、ロボットの「設計室（VS Code）」を開きましたね。
左側のファイル一覧が表示されているエリア（エクスプローラー）で右クリックし、**「新しいファイル」** を選びます。

ファイル名は `main.js` にしましょう。
`main` は「メインの、主要な」という意味で、プログラムの世界では「ここが処理の中心ですよ」という意図でよく使われる名前です。

### ⚠️ 豆知識：拡張子の話
- **Googleのサーバー上**: GASのファイルは `.gs` という名前です。
- **あなたのパソコン上**: 私たちは `.js` (JavaScript) という名前を使います。

「え、名前が違って大丈夫？」と不安になるかもしれませんが、全く問題ありません。
通訳ツールである `Clasp` が、あなたが書いた `.js` ファイルをGoogleに送るときに、**自動的に `.gs` に翻訳してくれます。**
パソコン上では `.js` にしておくことで、VS Codeの便利な機能（コードの色分けや入力補助）を最大限に活用できるので、開発がずっと楽になります。

## 2. ロボットへの最初の命令を書いてみる

作成した `main.js` に、以下の命令をコピー＆ペースト（または手入力）してみてください。
これは「『こんにちは！』と挨拶して、簡単な計算をする」という、ロボットへの最初の指示です。

```javascript
function doSomething() {
  // Logger.log は「これを記録しておいて」という命令
  Logger.log("こんにちは！初めての仕事です。");
  
  // 簡単な計算もできます
  const sales = 10000;
  const tax = sales * 0.1;
  Logger.log("売上10,000円の消費税は " + tax + " 円です。");
}
```

**このコードの意味**：
*   `Logger.log(...)`: ロボットの日記帳（ログ）に文字を書く命令です。
*   `const ...`: 数字や文字を入れておく「箱（変数）」を作ります。

今は「ふーん、こう書くんだ」くらいでOKです。

書き終わったら、キーボードの `Ctrl + S` (Macなら `Command + S`) を押して、ファイルを保存します。
**これを忘れると、せっかく書いた命令がパソコンの中に置かれたままで、ロボットに届きません！** 保存は癖にしましょう。

### 🤖 ここでAI Agent (Copilot) の出番！
もしあなたがGitHub Copilotを導入しているなら、魔法のような体験ができます。
「手打ち」は勉強にはなりますが、実務では **「Agentに書いてもらう」** のが基本です。

#### パターンA：コメントから生成する
書いたコードの続きに、日本語でこうコメントを書いてみてください。

```javascript
// 今日の日付を取得して、「本日のレポートです」という形式でログに出力する
```

と書いて Enter キーを押すと… 
AIがフワッと薄い文字で `const today = ...` のようなコードを提案してくるはずです。
その提案でよければ **Tabキー** を押すだけで、コードが自動で入力されます。

#### パターンB：チャットで依頼する (Agentモード)
VS Codeの左側にあるチャットアイコン（または `Ctrl + I`）を押して、こう入力してみてください。

> 「スプレッドシートのA列を全部読み込んで、ログに出すコードを書いて」

すると、Agentがコードを生成してくれます。あなたは「Accept（適用）」ボタンを押すだけ。
これが「AIとの共同作業」です。あなたはやりたいことを日本語で伝えるだけで、面倒なコーディングはAgentが肩代わりしてくれます。

## 3. 命令書をロボットに送信する (push)

あなたがパソコンで書いた命令書を、Googleのサーバーにいるロボット本体に送ります。これを **「プッシュ (push)」** と呼びます。
「手元の最新の指示を、向こう側にグッと押し込む」イメージです。

VS Codeの下の方にあるターミナル（もし無ければ `Ctrl + @` で開けます）で、以下のコマンドを入力します。

```bash
clasp push
```

画面に `Pushed 1 file.` のように表示されれば成功です。
これで、あなたのパソコンにあった `main.js` が、Googleのサーバーに `main.gs` として無事に届きました。

## 4. ロボットが正しく動くか、現場で確認する

命令がちゃんと届いて、ロボットが理解してくれたか確認しにいきましょう。

```bash
clasp open
```

このコマンドを打つと、ブラウザでGoogleのGAS開発画面（ロボットの現場）が開きます。
左側のファイル一覧に `main.gs` があり、中身が先ほど書いたコードと同じになっているはずです。

1.  上部のツールバーで、実行する命令 `doSomething` が選ばれていることを確認します。
2.  **「実行」** ボタンを押します。
3.  （初回のみ）「このロボットにあなたのGoogleデータへのアクセスを許可しますか？」という承認画面が出ます。
    *   ※もし「このアプリは確認されていません」という怖い画面が出ても大丈夫です。詳しい突破方法は [第8章：初心者が必ずハマるポイント集](https://www.zidooka.com/archives/1616) で解説しています。
4.  画面下の「実行ログ」に `こんにちは！...` と表示されれば大成功です！

**成功時のログ例**：
```text
情報	こんにちは！初めての仕事です。
情報	売上10,000円の消費税は 1000 円です。
```

## 5. よくある質問 (Q&A)

### Q1. `clasp push` を忘れるとどうなりますか？
**A. Google上のロボットは古い命令のまま動きます。**
「コードを直したのに直ってない！」という時は、十中八九 `clasp push` の忘れか、ファイルの保存忘れです。

### Q2. ファイル名は `main.js` 以外でもいいですか？
**A. はい、自由です。**
`invoice.js` や `report.js` など、中身がわかる名前をつけるのが良い習慣です。

### Q3. 日本語のコメントは消したほうがいいですか？
**A. いいえ、残しておきましょう。**
未来の自分へのメモになりますし、AIがコードを理解する助けにもなります。

## 6. 理解度チェッククイズ

**Q1. パソコン上でGASのコードを書くときの拡張子は？**
A. `.txt`
B. `.gs`
C. `.js`

**Q2. 書いたコードをGoogleに送信するコマンドは？**
A. `clasp send`
B. `clasp push`
C. `clasp upload`

**Q3. コードを変更したのに反映されない！原因として考えられるのは？**
A. ファイルを保存していない (`Ctrl+S` 忘れ)
B. `clasp push` をしていない
C. 両方

<details>
<summary>答え合わせ（クリックして開く）</summary>

**Q1: C**
パソコン上ではJavaScript (`.js`) として扱います。

**Q2: B**
「押し込む」イメージで `push` です。

**Q3: C**
保存して、プッシュする。この2ステップが必要です。

</details>

---

おめでとうございます！あなたは今、プロの開発者と同じサイクルを体験しました。

1.  **作る**: パソコン（VS Code）で命令（コード）を書く。
2.  **送る**: `clasp push` でロボットに送信する。
3.  **確認する**: `clasp open` で現場を見に行き、実行してみる。

この **「作って→送って→確認」** のリズムが、自動化ロボットを育てていく上での基本ステップになります。
最初は面倒に感じるかもしれませんが、慣れると数分でこなせるようになります。

次の章では、この開発サイクルをよりスムーズにし、安全に開発を進めるための「現場のルール」について学びます。

---
**次章でやること**：
*   `clasp pull` でクラウドの変更を取り込む
*   「先祖返り」事故を防ぐための鉄則
*   チーム開発の第一歩

[＞＞ 次の章：第6章 push / pull を理解する](https://www.zidooka.com/archives/1604)

