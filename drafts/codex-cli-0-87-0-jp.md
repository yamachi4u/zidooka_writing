---
title: "Codex CLI 0.87.0 リリース！シェル設定の読み込み対応やWindowsでのUTF-8デフォルト化など【2026年1月】"
date: "2026-01-20T12:00:00"
categories: 
  - "AI"
tags: 
  - "OpenAI"
  - "Codex"
  - "CLI"
  - "Update"
slug: codex-cli-0-87-0-update-jp
---

2026年1月、OpenAIのCodex CLIがバージョン **0.87.0** にアップデートされました。
今回のアップデートでは、ユーザー体験を向上させる地味ながら重要な変更がいくつも含まれています。

特に、シェル設定（`.bashrc` やエイリアス）が反映されるようになった点や、Windowsユーザー向けの文字コード対応などは、日々の開発作業をよりスムーズにしてくれるでしょう。

以下、リリースノートの主要な変更点を日本語で解説します。

## 主な新機能 (New Features)

### 1. メタデータの永続化
ユーザーメッセージのメタデータ（テキスト要素やバイト範囲など）が、プロトコル、アプリサーバー、コアを通じて正しく循環（ラウンドトリップ）するようになりました。
これにより、履歴が再構築された場合でも、UI上のアノテーション（注釈）が消えずに維持されるようになります。

### 2. コラボレーション機能の強化
コラボレーション時の「待機（wait）」呼び出しにおいて、1つのリクエストで複数のIDをブロックできるようになりました。これにより、マルチスレッドでの調整処理が簡素化されます。

### 3. ユーザーシェル設定の反映
これが今回の一番の目玉かもしれません。
ユーザーのシェルコマンドが「ユーザースナップショット」の下で実行されるようになりました。つまり、**ユーザーが設定したエイリアスやシェル設定（`.zshrc` や `.bash_profile` など）がCodex内でも尊重される**ようになります。

### 4. TUI（ターミナルUI）の改善
派生したスレッドや、未購読のスレッドからの承認リクエストが、TUI上に表示されるようになりました。バックグラウンドで動いているタスクの承認漏れを防げそうです。

## バグ修正 (Bug Fixes)

*   **トークン見積もりの精度向上:** "Compaction"（コンテキスト圧縮）中のトークン見積もりが正確になりました。長時間セッションでのトークン予算管理（Budgeting）がより確実になります。
*   **MCP（Model Context Protocol）の改善:** `CallToolResult` に `threadId` が含まれるようになり、互換性のための出力スキーマが定義されました。
*   **「作業時間」表示の修正:** TUIの "Worked for"（～のために作業中）という区切り線が、実際に作業が発生した後にのみ表示されるように修正されました。
*   **パイプ処理の修正:** PTY以外（非対話型）のコマンドをパイプで繋いだ際、標準入力を待ったままハングしてしまう問題が解消されました。

## その他の変更

*   **WindowsのUTF-8デフォルト化:** Windowsビルドにおいて、PowerShellのUTF-8機能がデフォルトで有効になりました。文字化けトラブルが減ることが期待できます。
*   **ドキュメント更新:** MCPインターフェースのドキュメントが更新され、構造化出力スキーマや `threadId` の挙動について反映されました。

---

## 【ネタ】CodexにCodexをアップデートさせてみた

今回のアップデートに気づいたので、手元の環境も更新しようと思ったのですが、ふと「**Codex自身に自分をアップデートさせたらどうなるんだろう？**」という疑問が湧きました。

というわけで、やってみました。

![CodexでCodexをアップデート](../images/image%20copy%2013.png)

単なるネタですが、ちゃんとコマンドを理解して実行してくれるのか、あるいは「自分自身を書き換えることはできません」と拒否するのか……（笑）。
結果は画像の通りです。AIが自分自身を進化させる（？）第一歩かもしれませんね。

皆さんも最新版 0.87.0、ぜひ試してみてください。
